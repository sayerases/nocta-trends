<!-- Video Analysis Page -->
<div class="page-title" style="margin-bottom:8px;">AI Анализ Видео</div>
<div style="color:var(--text-muted); margin-bottom:24px;">Вставьте ссылку на любой Instagram Reel для глубокого разбора
    хуков и сценария. Стоимость: 10 токенов.</div>

<div class="search-box" style="margin-bottom:30px; max-width:800px;">
    <svg class="icon" style="color:var(--text-muted)">
        <path
            d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-9 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z" />
    </svg>
    <input type="text" id="url-input" placeholder="https://www.instagram.com/reel/ХХХХХХ/"
        onkeydown="if(event.key==='Enter') runSingleAnalysis()">
    <button class="btn btn-primary" style="margin-left:10px;" onclick="runSingleAnalysis()">Разбор (10 т.)</button>
</div>

<div id="analysis-result-container"></div>

<script>
    function runSingleAnalysis() {
        const url = document.getElementById('url-input').value.trim();
        if (!url) return;

        const container = document.getElementById('analysis-result-container');
        container.innerHTML = '<div style="text-align:center; padding:40px;"><div class="spinner" style="margin:0 auto;"></div><div style="margin-top:16px;">Нейросеть пишет отчет... Это может занять до 20 секунд.</div></div>';

        const fd = new FormData(); fd.append("video_url", url); fd.append("platform", "instagram");
        fetch('/api/analyze', { method: 'POST', body: fd })
            .then(r => r.text())
            .then(html => { container.innerHTML = html; });
    }
</script>